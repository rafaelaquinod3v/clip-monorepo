<div class="main-container">
  <div class="mat-card">
    <h2 class="mat-title">Procesador de Archivos JSON</h2>
    
    <!-- SECCIÓN 1: SELECCIÓN Y SUBIDA -->
    <div class="upload-section">
      <label class="custom-file-upload">
        <input type="file" (change)="onFileSelected($event)">
        <span>{{ selectedFile ? selectedFile.name : 'Seleccionar archivo' }}</span>
      </label>
      <select #langSelect (change)="selectedLang = langSelect.value" class="mat-select-language">
        <option value="EN">Inglés</option>
        <option value="ES">Español</option>
      </select>
      <button class="mat-button-primary" (click)="onUpload()" [disabled]="!selectedFile">
        Subir
      </button>
    </div>

    <!-- BARRA 1: PROGRESO DE SUBIDA (XHR/HTTP) -->
    <div *ngIf="progress > 0" class="upload-progress-container">
      <div class="progress-labels">
        <small>Subiendo archivo...</small>
        <small>{{ progress }}%</small>
      </div>
      <progress [value]="progress" max="100" class="mat-progress upload-bar"></progress>
    </div>

    <hr *ngIf="progressData" class="divider">

    <!-- BARRA 2: PROGRESO DE PROCESAMIENTO (SOCKETS) -->
    <div *ngIf="progressData" class="progress-wrapper">
      <div class="progress-header">
        <span class="status-tag" [ngClass]="progressData.status">
          {{ progressData.status }}
        </span>
        <span class="count-text">{{ progressData.current }} de {{ progressData.total }}</span>
      </div>
      
      <progress [value]="progressData.percentage" max="100" class="mat-progress processing-bar"></progress>
      
      <div class="progress-footer">
        <span class="percentage-label">Procesando contenido: {{ progressData.percentage }}%</span>
      </div>
    </div>

    <p *ngIf="mensaje" class="mat-hint">{{ mensaje }}</p>
  </div>
</div>
